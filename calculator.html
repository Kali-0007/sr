<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax Computation Tool – TaxGSTPro (FY 2025-26)</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.32/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: #000;
            color: #fff;
            line-height: 1.6;
        }
        .tool-container {
            max-width: 950px;
            margin: 40px auto;
            background: #111;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            overflow: hidden;
        }
        .tool-header {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            padding: 32px;
            text-align: center;
            position: relative;
        }
        .tool-header i { font-size: 48px; margin-bottom: 12px; display: block; }
        .step-indicator {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            background: #222;
        }
        .step {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 12px;
            font-weight: 600;
            color: #fff;
            transition: background 0.3s;
        }
        .step.active { background: #4a90e2; }
        .step.completed { background: #28a745; }
        .tool-form {
            padding: 30px;
        }
        .form-step {
            display: none;
        }
        .form-step.active { display: block; }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        label { font-weight: 600; margin-bottom: 6px; display: block; color: #ccc; }
        input, select {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #444;
            background: #222;
            color: #fff;
            box-sizing: border-box;
            transition: border 0.3s;
        }
        input:focus, select:focus { border-color: #4a90e2; outline: none; }
        input::placeholder { color: #888; }
        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            justify-content: center;
        }
        button {
            padding: 14px 24px;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        .btn-primary { background: #4a90e2; color: #fff; }
        .btn-primary:hover { background: #357abd; }
        .btn-secondary { background: #555; color: #fff; }
        .btn-secondary:hover { background: #666; }
        .reset-btn { background: #dc3545; color: #fff; width: auto; }
        .download-btns {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 24px;
        }
        .download-btn { padding: 12px 20px; background: #28a745; color: #fff; }
        .download-btn:hover { background: #218838; }
        .computation-results {
            padding: 30px;
            display: none;
            background: #111;
            border-top: 1px solid #333;
        }
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: #222;
        }
        .results-table th, .results-table td {
            padding: 14px;
            border-bottom: 1px solid #444;
            text-align: left;
        }
        .results-table th { background: #4a90e2; color: #fff; }
        .highlight-tax {
            color: #28a745;
            font-weight: bold;
            font-size: 18px;
        }
        .slab-breakdown {
            margin-top: 10px;
            font-size: 14px;
            color: #ccc;
            background: #333;
            padding: 8px;
            border-radius: 4px;
        }
        small { color: #888; font-size: 12px; }
        @media (max-width: 600px) {
            .form-grid { grid-template-columns: 1fr; }
            .btn-group, .download-btns { flex-direction: column; }
        }
        .close-calculator {
            position: absolute;
            top: 18px;
            right: 22px;
            background: rgba(0,0,0,0.4);
            border: none;
            color: #fff;
            font-size: 22px;
            font-weight: 600;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.3s, transform 0.2s;
        }
        .close-calculator:hover {
            background: #dc3545;
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <header class="tool-header">
            <i class="fas fa-calculator"></i>
            <h1>Tax Computation Tool</h1>
            <div>Comprehensive Analysis for FY 2025-26 (AY 2026-27)</div>
            <!-- Close Button -->
            <button class="close-calculator" onclick="closeCalculator()">✕</button>
        </header>
        <div class="step-indicator" id="stepIndicator">
            <div class="step active" data-step="1">1</div>
            <div class="step" data-step="2">2</div>
            <div class="step" data-step="3">3</div>
            <div class="step" data-step="4">4</div>
        </div>
        <form id="taxForm" class="tool-form">
            <!-- Step 1: Tax Profile -->
            <div class="form-step active" data-step="1">
                <h3><i class="fas fa-user"></i> Step 1: Tax Profile</h3>
                <div class="form-grid">
                    <div>
                        <label>Age Category</label>
                        <select id="ageGroup">
                            <option value="under60">Below 60 years</option>
                            <option value="senior">60-79 years (Senior)</option>
                            <option value="superSenior">80+ years (Super Senior)</option>
                        </select>
                    </div>
                    <div>
                        <label>Residency</label>
                        <select id="residentialStatus">
                            <option value="resident">Resident Indian</option>
                            <option value="nri">Non-Resident Indian</option>
                        </select>
                    </div>
                    <div style="grid-column: 1 / -1;">
                        <label>Annual Salary (pre-exemptions, ₹)</label>
                        <input type="number" id="totalSalary" value="0" min="0" placeholder="e.g., 1000000">
                        <small>Basic pay + allowances</small>
                    </div>
                    <div>
                        <label>HRA Relief (₹)</label>
                        <input type="number" id="hraExemption" value="0" min="0" placeholder="0">
                    </div>
                    <div>
                        <label>Additional Exemptions (₹)</label>
                        <input type="number" id="otherExemptions" value="0" min="0" placeholder="0">
                    </div>
                </div>
                <div class="btn-group">
                    <button type="button" class="btn-secondary" onclick="nextStep(2)">Next</button>
                </div>
            </div>
            <!-- Step 2: Income Streams -->
            <div class="form-step" data-step="2">
                <h3><i class="fas fa-chart-line"></i> Step 2: Income Streams</h3>
                <div class="form-grid">
                    <div>
                        <label>Other Earnings (₹)</label>
                        <input type="number" id="otherIncome" value="0" min="0" placeholder="0">
                    </div>
                    <div>
                        <label>Rent Received (₹)</label>
                        <input type="number" id="rentalIncome" value="0" min="0" placeholder="0">
                    </div>
                    <div>
                        <label>Capital Gains (₹)</label>
                        <input type="number" id="capitalGains" value="0" min="0" placeholder="0">
                    </div>
                    <div>
                        <label>Business Earnings (₹)</label>
                        <input type="number" id="businessIncome" value="0" min="0" placeholder="0">
                    </div>
                    <div>
                        <label>Property Loan Interest - Rented (₹)</label>
                        <input type="number" id="homeLoanLetOut" value="0" min="0" placeholder="0">
                    </div>
                    <div>
                        <label>Property Loan Interest - Owned (max ₹2L, ₹)</label>
                        <input type="number" id="homeLoanSelf" value="0" min="0" max="200000" placeholder="0">
                    </div>
                </div>
                <div class="btn-group">
                    <button type="button" class="btn-secondary" onclick="prevStep(1)">Previous</button>
                    <button type="button" class="btn-primary" onclick="nextStep(3)">Next</button>
                </div>
            </div>
            <!-- Step 3: Deductions -->
            <div class="form-step" data-step="3">
                <h3><i class="fas fa-shield-alt"></i> Step 3: Allowable Deductions (Traditional Regime)</h3>
                <p style="color: #ccc;">New regime limits to standard deduction only.</p>
                <div class="form-grid">
                    <div>
                        <label>80C Investments (max ₹1.5L, ₹)</label>
                        <input type="number" id="section80C" value="0" min="0" max="150000" placeholder="0">
                    </div>
                    <div>
                        <label>80D Insurance (max ₹50K, ₹)</label>
                        <input type="number" id="section80D" value="0" min="0" max="50000" placeholder="0">
                    </div>
                    <div>
                        <label>80G Contributions (₹)</label>
                        <input type="number" id="section80G" value="0" min="0" placeholder="0">
                    </div>
                    <div>
                        <label>80E Loan Interest (₹)</label>
                        <input type="number" id="section80E" value="0" min="0" placeholder="0">
                    </div>
                    <div>
                        <label>80TTA Savings (max ₹10K, ₹)</label>
                        <input type="number" id="section80TTA" value="0" min="0" max="10000" placeholder="0">
                    </div>
                    <div style="grid-column: 1 / -1;">
                        <label>Further Deductions (₹)</label>
                        <input type="number" id="otherDeductions" value="0" min="0" placeholder="0">
                    </div>
                </div>
                <div class="btn-group">
                    <button type="button" class="btn-secondary" onclick="prevStep(2)">Previous</button>
                    <button type="button" id="generateBtn" class="btn-primary">Generate Report</button>
                </div>
            </div>
        </form>
        <div id="results" class="computation-results">
            <h2><i class="fas fa-file-invoice"></i> Computation Summary</h2>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Traditional Regime</th>
                        <th>New Regime</th>
                    </tr>
                </thead>
                <tbody id="resultsTable">
                    <!-- Dynamically populated -->
                </tbody>
            </table>
            <div class="download-btns">
                <button class="download-btn" onclick="downloadPDF()"><i class="fas fa-file-pdf"></i> Download as PDF</button>
                <button class="download-btn" onclick="downloadExcel()"><i class="fas fa-file-excel"></i> Download as Excel</button>
            </div>
            <button type="button" class="reset-btn" onclick="resetForm()" style="margin-top: 20px; display: block; margin-left: auto; margin-right: auto;">New Computation</button>
        </div>
    </div>
    <script>
        // Utility Functions
        function formatINR(n) {
            return new Intl.NumberFormat('en-IN').format(Math.round(n || 0));
        }
        // Close Calculator Function
        function closeCalculator() {
            window.location.href = "index.html";
        }
        // Step Navigation
        function updateSteps(currentStep) {
            document.querySelectorAll('.step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < currentStep - 1) step.classList.add('completed');
                if (index === currentStep - 1) step.classList.add('active');
            });
            document.querySelectorAll('.form-step').forEach((s, i) => {
                s.classList.toggle('active', i === currentStep - 1);
            });
        }
        function nextStep(step) { updateSteps(step); }
        function prevStep(step) { updateSteps(step); }
        updateSteps(1);
        // Reset Function
        function resetForm() {
            document.getElementById('taxForm').reset();
            document.getElementById('results').style.display = 'none';
            updateSteps(1);
        }
        // Tax Calculation Logic
        function calculateTax(income, regime, ageGroup, isResident) {
            let tax = 0;
            let slabs = [];
            let rebate = 0;
            let preRebateTax = 0;
            let stdDeduction = regime === 'old' ? 50000 : 75000;
            let totalTaxable = Math.max(0, income - stdDeduction);
            if (regime === 'new') {
                preRebateTax = 0;
                if (totalTaxable <= 400000) {
                    preRebateTax = 0;
                } else if (totalTaxable <= 800000) {
                    preRebateTax = (totalTaxable - 400000) * 0.05;
                    slabs.push('5% on ₹4L-₹8L');
                } else if (totalTaxable <= 1200000) {
                    preRebateTax = 20000 + (totalTaxable - 800000) * 0.10;
                    slabs.push('5% on ₹4L-₹8L', '10% on ₹8L-₹12L');
                } else if (totalTaxable <= 1600000) {
                    preRebateTax = 60000 + (totalTaxable - 1200000) * 0.15;
                    slabs.push('5% on ₹4L-₹8L', '10% on ₹8L-₹12L', '15% on ₹12L-₹16L');
                } else if (totalTaxable <= 2000000) {
                    preRebateTax = 120000 + (totalTaxable - 1600000) * 0.20;
                    slabs.push('5% on ₹4L-₹8L', '10% on ₹8L-₹12L', '15% on ₹12L-₹16L', '20% on ₹16L-₹20L');
                } else if (totalTaxable <= 2400000) {
                    preRebateTax = 200000 + (totalTaxable - 2000000) * 0.25;
                    slabs.push('5% on ₹4L-₹8L', '10% on ₹8L-₹12L', '15% on ₹12L-₹16L', '20% on ₹16L-₹20L', '25% on ₹20L-₹24L');
                } else {
                    preRebateTax = 300000 + (totalTaxable - 2400000) * 0.30;
                    slabs.push('5% on ₹4L-₹8L', '10% on ₹8L-₹12L', '15% on ₹12L-₹16L', '20% on ₹16L-₹20L', '25% on ₹20L-₹24L', '30% above ₹24L');
                }
                rebate = totalTaxable <= 1200000 ? preRebateTax : 0;
            } else {
                // Old Regime
                let exemptionLimit = ageGroup === 'under60' ? 250000 : ageGroup === 'senior' ? 300000 : 500000;
                let fivePercentWidth = 500000 - exemptionLimit;
                preRebateTax = 0;
                if (ageGroup === 'superSenior') {
                    if (totalTaxable > 500000 && totalTaxable <= 1000000) {
                        preRebateTax = (totalTaxable - 500000) * 0.20;
                        slabs.push('20% on ₹5L-₹10L');
                    } else if (totalTaxable > 1000000) {
                        preRebateTax = 100000 + (totalTaxable - 1000000) * 0.30;
                        slabs.push('20% on ₹5L-₹10L', '30% above ₹10L');
                    }
                    // Nil up to 5L implicit
                } else {
                    if (totalTaxable > exemptionLimit && totalTaxable <= 500000) {
                        preRebateTax = (totalTaxable - exemptionLimit) * 0.05;
                        slabs.push(`5% above ₹${exemptionLimit / 1000}L up to ₹5L`);
                    } else if (totalTaxable > 500000 && totalTaxable <= 1000000) {
                        preRebateTax = fivePercentWidth * 0.05 + (totalTaxable - 500000) * 0.20;
                        slabs.push(`5% above ₹${exemptionLimit / 1000}L up to ₹5L`, '20% on ₹5L-₹10L');
                    } else if (totalTaxable > 1000000) {
                        preRebateTax = fivePercentWidth * 0.05 + 500000 * 0.20 + (totalTaxable - 1000000) * 0.30;
                        slabs.push(`5% above ₹${exemptionLimit / 1000}L up to ₹5L`, '20% on ₹5L-₹10L', '30% above ₹10L');
                    }
                    // Nil up to exemption implicit
                }
                rebate = isResident && totalTaxable <= 500000 ? Math.min(preRebateTax, 12500) : 0;
            }
            tax = Math.max(0, preRebateTax - rebate);
            // Surcharge
            let surchargeRate = 0;
            if (totalTaxable > 5000000) {
                if (totalTaxable <= 10000000) surchargeRate = 0.10;
                else if (totalTaxable <= 20000000) surchargeRate = 0.15;
                else if (totalTaxable <= 50000000) surchargeRate = 0.25;
                else surchargeRate = regime === 'new' ? 0.25 : 0.37;
                tax *= (1 + surchargeRate);
            }
            // Cess
            tax *= 1.04;
            tax = Math.round(tax);
            preRebateTax = Math.round(preRebateTax);
            rebate = Math.round(rebate);
            return {
                tax,
                preRebateTax,
                rebateAmount: rebate,
                slabs: slabs.join(', '),
                stdDeduction,
                taxableIncome: Math.round(totalTaxable)
            };
        }
        // Generate Report
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('generateBtn').addEventListener('click', function(e) {
                e.preventDefault();
                const ageGroup = document.getElementById('ageGroup').value;
                const isResident = document.getElementById('residentialStatus').value === 'resident';
                const netSalary = parseFloat(document.getElementById('totalSalary').value || 0) - parseFloat(document.getElementById('hraExemption').value || 0) - parseFloat(document.getElementById('otherExemptions').value || 0);
                const otherIncome = parseFloat(document.getElementById('otherIncome').value || 0);
                const rentalIncome = parseFloat(document.getElementById('rentalIncome').value || 0) - parseFloat(document.getElementById('homeLoanLetOut').value || 0);
                const homeLoanSelf = parseFloat(document.getElementById('homeLoanSelf').value || 0);
                const capitalGains = parseFloat(document.getElementById('capitalGains').value || 0);
                const businessIncome = parseFloat(document.getElementById('businessIncome').value || 0);
                let grossIncome = netSalary + otherIncome + rentalIncome + capitalGains + businessIncome;
                const deductions = parseFloat(document.getElementById('section80C').value || 0) +
                                  parseFloat(document.getElementById('section80D').value || 0) +
                                  parseFloat(document.getElementById('section80G').value || 0) +
                                  parseFloat(document.getElementById('section80E').value || 0) +
                                  parseFloat(document.getElementById('section80TTA').value || 0) +
                                  parseFloat(document.getElementById('otherDeductions').value || 0) +
                                  homeLoanSelf;
                let oldIncome = Math.max(0, grossIncome - deductions);
                let oldResult = calculateTax(oldIncome, 'old', ageGroup, isResident);
                let newIncome = grossIncome;
                let newResult = calculateTax(newIncome, 'new', ageGroup, isResident);
                const tableBody = document.getElementById('resultsTable');
                const regimeAdvantage = oldResult.tax - newResult.tax;
                const recommendedRegime = oldResult.tax > newResult.tax ? 'New' : 'Traditional';
                tableBody.innerHTML = `
                    <tr><td>Total Earnings</td><td>${formatINR(grossIncome)}</td><td>${formatINR(grossIncome)}</td></tr>
                    <tr><td>Standard Relief</td><td>${formatINR(oldResult.stdDeduction)}</td><td>${formatINR(newResult.stdDeduction)}</td></tr>
                    <tr><td>Deductions Applied (Traditional)</td><td>${formatINR(deductions)}</td><td>₹0</td></tr>
                    <tr><td>Assessable Income</td><td>${formatINR(oldResult.taxableIncome)}</td><td>${formatINR(newResult.taxableIncome)}</td></tr>
                    <tr><td>Tax Before Rebate</td><td class="highlight-tax">${formatINR(oldResult.preRebateTax)}</td><td class="highlight-tax">${formatINR(newResult.preRebateTax)}</td></tr>
                    <tr><td>87A Rebate</td><td>${formatINR(oldResult.rebateAmount)}</td><td>${formatINR(newResult.rebateAmount)}</td></tr>
                    <tr><td>Final Liability (incl. Cess & Surcharge)</td><td class="highlight-tax">${formatINR(oldResult.tax)}</td><td class="highlight-tax">${formatINR(newResult.tax)}</td></tr>
                    <tr><td>Regime Advantage</td><td colspan="2" style="text-align:center; color:#28a745; font-weight:600;">${formatINR(Math.abs(regimeAdvantage))} (Opt for ${recommendedRegime} Regime)</td></tr>
                    <tr><td>Rate Structure (Traditional)</td><td colspan="2"><div class="slab-breakdown">${oldResult.slabs || 'Nil'}</div></td></tr>
                    <tr><td>Rate Structure (New)</td><td colspan="2"><div class="slab-breakdown">${newResult.slabs || 'Nil'}</div></td></tr>
                `;
                document.getElementById('results').style.display = 'block';
                window.scrollTo(0, document.getElementById('results').offsetTop);
                updateSteps(4);
                // Store for downloads
                window.taxData = {
                    grossIncome, deductions,
                    oldTax: oldResult.tax, newTax: newResult.tax,
                    oldTaxable: oldResult.taxableIncome, newTaxable: newResult.taxableIncome,
                    oldPreRebate: oldResult.preRebateTax, newPreRebate: newResult.preRebateTax,
                    oldRebate: oldResult.rebateAmount, newRebate: newResult.rebateAmount,
                    oldSlabs: oldResult.slabs, newSlabs: newResult.slabs,
                    oldStd: oldResult.stdDeduction, newStd: newResult.stdDeduction,
                    timestamp: new Date().toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' })
                };
            });
        });
        // PDF Download
        function downloadPDF() {
            if (typeof window.taxData === 'undefined') {
                alert('Please calculate tax first.');
                return;
            }
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            /* Header */
            doc.setFillColor(74, 144, 226);
            doc.rect(0, 0, 210, 50, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(20);
            doc.text('Tax Computation Tool', 15, 22);
            doc.setFontSize(12);
            doc.text('– TaxGSTPro (FY 2025-26)', 15, 32);
            doc.setFontSize(10);
            doc.text('Comprehensive Analysis for AY 2026-27', 15, 42);
           
            doc.setTextColor(0);
            let y = 60;
            const g = window.taxData;
            doc.setFontSize(12);
            doc.text(`Generated On: ${g.timestamp}`, 15, y); y += 15;
           
            // Table for Computation
            const recommended = g.oldTax > g.newTax ? 'New Regime' : 'Traditional Regime';
            const advantage = Math.abs(g.oldTax - g.newTax);
            const tableData = [
                ['Component', 'Traditional Regime (₹)', 'New Regime (₹)'],
                ['Total Earnings', formatINR(g.grossIncome), formatINR(g.grossIncome)],
                ['Standard Relief', formatINR(g.oldStd), formatINR(g.newStd)],
                ['Deductions Applied', formatINR(g.deductions), '₹0'],
                ['Assessable Income', formatINR(g.oldTaxable), formatINR(g.newTaxable)],
                ['Tax Before Rebate', formatINR(g.oldPreRebate), formatINR(g.newPreRebate)],
                ['87A Rebate', formatINR(g.oldRebate), formatINR(g.newRebate)],
                ['Final Liability (incl. Cess & Surcharge)', formatINR(g.oldTax), formatINR(g.newTax)],
                ['Regime Advantage', `${formatINR(advantage)} (Opt for ${recommended})`, ' '],
                ['Rate Structure', `Traditional: ${g.oldSlabs || 'Nil'}`, `New: ${g.newSlabs || 'Nil'}`]
            ];
           
            doc.autoTable({
                startY: y,
                head: [tableData[0]],
                body: tableData.slice(1),
                theme: 'grid',
                styles: {
                    fontSize: 9,
                    cellPadding: 3,
                    overflow: 'linebreak',
                    halign: 'left',
                    fillColor: [37, 37, 37],
                    textColor: [255, 255, 255],
                    lineColor: [68, 68, 68],
                    lineWidth: 0.1
                },
                headStyles: {
                    fillColor: [74, 144, 226],
                    textColor: [255, 255, 255],
                    fontStyle: 'bold'
                },
                columnStyles: {
                    0: { cellWidth: 50 },
                    1: { cellWidth: 80 },
                    2: { cellWidth: 80 }
                },
                margin: { left: 15, right: 15 }
            });
           
            y = doc.lastAutoTable.finalY + 10;
           
            // Footer
            y = 285;
            doc.setFontSize(9);
            doc.setTextColor(120);
            doc.setFont('helvetica', 'normal');
            doc.text('System generated report – For advisory use only', 105, y, { align: 'center' });
           
            doc.save('TaxGSTPro_Tax_Report_FY_2025_26.pdf');
        }
        // Excel Download
        function downloadExcel() {
            if (!window.taxData) {
                alert('Please generate computation first');
                return;
            }
            const wsData = [
                ["INCOME TAX COMPUTATION – FY 2025-26 (AY 2026-27)"],
                [],
                ["Particulars", "Traditional Regime (₹)", "New Regime (₹)"],
                ["Gross Total Income", window.taxData.grossIncome, window.taxData.grossIncome],
                ["Less: Deductions", window.taxData.deductions, 0],
                ["Taxable Income", window.taxData.oldTaxable, window.taxData.newTaxable],
                [],
                ["Income Tax Payable"],
                ["Final Tax Liability (incl. cess)", window.taxData.oldTax, window.taxData.newTax],
                [],
                [
                    "Recommended Regime",
                    window.taxData.oldTax > window.taxData.newTax ? "New Regime" : "Traditional Regime",
                    ""
                ],
                [],
                ["Generated on", window.taxData.timestamp]
            ];
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Tax Computation");
            XLSX.writeFile(wb, "Income_Tax_Computation_FY_2025_26.xlsx");
        }
    </script>
</body>
</html>
