<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Partner Program â€“ TaxEasePro</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    :root {
      --bg: #030308;
      --teal: #00c4b4;
      --gold: #d4af37;
      --text: #ffffff;
      --text-dim: #94a3b8;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background-color: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; line-height: 1.8; overflow-x: hidden; }
    /* --- HERO SECTION --- */
    .hero-container {
      width: 100%; height: 100vh;
      background: url('partner1.png') no-repeat;
      background-size: cover;
      background-position: center -80px;
      position: relative;
    }
    .hero-container::after {
      content: ""; position: absolute; bottom: 0; left: 0; width: 100%; height: 45vh;
      background: linear-gradient(to top, var(--bg) 25%, transparent 100%);
      z-index: 2;
    }
    /* --- LOGIN SECTION --- */
    .login-section {
      position: relative; z-index: 10; display: flex; flex-direction: column; align-items: center;
      padding: 0 20px 80px; background: var(--bg); margin-top: -40px;
    }
    .logo-main {
      font-size: 5.5rem; font-weight: 800; letter-spacing: -3px;
      background: linear-gradient(135deg, var(--teal), var(--gold));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center;
    }
    .tagline {
      font-size: 1.2rem; font-weight: 400; color: var(--text-dim);
      margin-bottom: 50px; letter-spacing: 4px; text-transform: uppercase;
    }
    /* --- RESPONSIVE FIXES --- */
    @media (max-width: 1024px) {
      .hero-container { height: 50vh; background-size: cover; }
      .hero-container::after { height: 20vh; background: linear-gradient(to top, var(--bg) 0%, rgba(3, 3, 8, 0.5) 40%, transparent 100%); opacity: 0.8; }
    }
    @media (max-width: 480px) {
      .hero-container { height: 45vh; background-size: 115% auto; background-position: 30% 0px; }
      .login-section { margin-top: -110px; }
      .logo-main { font-size: 3.2rem; }
      .tagline { font-size: 0.8rem; letter-spacing: 2px; }
    }
    /* --- LOGIN CONTROLS --- */
    .login-controls { width: 100%; max-width: 420px; }
    .consent-item { display: flex; gap: 12px; margin-bottom: 20px; font-size: 0.95rem; color: var(--text-dim); cursor: pointer; }
    input[type="checkbox"] { width: 20px; height: 20px; accent-color: var(--teal); flex-shrink: 0; }
  
    .google-btn {
      width: 100%; padding: 20px; border: 1px solid rgba(255,255,255,0.2);
      background: transparent; color: #fff; font-size: 1.1rem; font-weight: 700;
      display: flex; align-items: center; justify-content: center; gap: 12px; cursor: pointer; transition: 0.3s;
    }
    .google-btn:not(:disabled):hover { background: #fff; color: #000; }
    .google-btn:disabled { opacity: 0.2; cursor: not-allowed; }
  
    #statusMessage { margin-top: 15px; font-size: 14px; text-align: center; min-height: 20px; }
    .trust-badges { margin-top: 30px; display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; font-size: 0.8rem; color: var(--teal); font-weight: 600; opacity: 0.8; }
    /* --- CONTENT FLOW --- */
    .content-flow { max-width: 850px; margin: 80px auto; padding: 0 25px; }
    .section-head { font-size: clamp(2rem, 5vw, 2.8rem); font-weight: 800; margin-bottom: 70px; text-align: center; color: var(--gold); }
    .process-row { margin-bottom: 60px; padding-left: 20px; border-left: 1px solid var(--teal); }
    .step-marker { color: var(--teal); font-weight: 800; font-size: 0.8rem; letter-spacing: 2px; display: block; margin-bottom: 10px; }
    .process-row h3 { font-size: clamp(1.4rem, 3vw, 1.8rem); margin-bottom: 12px; color: #fff; }
    .process-row p { font-size: 1.05rem; color: var(--text-dim); margin-bottom: 10px; }
    .process-row ul { list-style: none; margin-top: 10px; }
    .process-row li { position: relative; padding-left: 25px; margin-bottom: 8px; color: var(--text-dim); }
    .process-row li::before { content: "â†’"; position: absolute; left: 0; color: var(--gold); }
    .example-box { background: #0a0a15; border: 1px solid rgba(212, 175, 55, 0.3); padding: 40px 25px; border-radius: 4px; text-align: center; margin: 80px 0; }
    .example-box h2 { font-size: clamp(1.8rem, 4vw, 2.5rem); color: var(--teal); margin-bottom: 10px; }
    .highlight-gold { color: var(--gold); font-weight: 700; }
    .highlights-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-top: 80px; }
    .highlight-pill { border: 1px solid rgba(0, 196, 180, 0.3); padding: 20px; text-align: center; font-weight: 600; font-size: 0.9rem; color: var(--teal); }
  </style>
</head>
<body>
  <div class="hero-container"></div>
  <section class="login-section">
    <div class="logo-main">TaxEasePro</div>
    <div class="tagline">Exclusive Partner Access</div>
    <div class="login-controls">
      <label class="consent-item">
        <input type="checkbox" id="c1" onchange="updateButtonState()">
        <span>I agree to the <a href="privacy-policy.html" target="_blank" style="color:var(--teal); text-decoration:none">Privacy Policy</a></span>
      </label>
      <label class="consent-item">
        <input type="checkbox" id="c2" onchange="updateButtonState()">
        <span>I accept the <a href="terms-of-service.html" target="_blank" style="color:var(--teal); text-decoration:none">Terms & Conditions</a></span>
      </label>
      <div id="googleSignInButton" style="width: 100%; max-width: 420px; margin: 0 auto; opacity: 0.4; pointer-events: none;"></div>
      <div id="statusMessage"></div>
    </div>
    <div class="trust-badges">
      <span>ðŸ”’ SECURE LOGIN</span>
      <span>âœ… DPDP COMPLIANT</span>
      <span>âœ… 256-BIT ENCRYPTION</span>
    </div>
  </section>
  <section class="content-flow">
    <h2 class="section-head">How Agents Earn Money</h2>
    <div class="process-row">
      <span class="step-marker">STEP 01</span>
      <h3>Sign Up for Free (Takes 1 Minute)</h3>
      <p>Click "Continue with Google" on the login page. No password, no long form â€“ your account is created automatically using your Google info.</p>
    </div>
    <div class="process-row">
      <span class="step-marker">STEP 02</span>
      <h3>Get Your Unique Partner Code</h3>
      <p>After login, go to your dashboard. You will instantly receive a personal referral code (e.g., TAXEASE-XXXXXX). This code belongs only to you.</p>
    </div>
    <div class="process-row">
      <span class="step-marker">STEP 03</span>
      <h3>Share Your Code with Clients</h3>
      <p>Share the code with your network via WhatsApp or call. When any client uses your code for GST/ITR services, <span class="highlight-gold">they get 5% instant discount</span>.</p>
    </div>
    <div class="process-row">
      <span class="step-marker">STEP 04</span>
      <h3>Earn Commission Automatically</h3>
      <ul>
        <li><b>10% commission</b> for general partners.</li>
        <li><b>20% commission</b> for CA and CS partners.</li>
        <li>Commission is <span class="highlight-gold">Lifetime Recurring</span> â€“ earn every month.</li>
      </ul>
    </div>
    <div class="example-box">
      <p style="letter-spacing: 2px; font-size: 0.8rem; margin-bottom: 15px;">INCOME EXAMPLE</p>
      <h2>â‚¹1,000 / Per Client</h2>
      <p>If a client pays â‚¹5,000/month, you earn up to â‚¹1,000 every single month â€” <b>forever!</b></p>
    </div>
    <div class="process-row">
      <span class="step-marker">STEP 05</span>
      <h3>Track Everything in Your Dashboard</h3>
      <p>Log in anytime to see live updates: Number of referred clients, total commission earned, and payout history.</p>
    </div>
    <div class="process-row">
      <span class="step-marker">STEP 06</span>
      <h3>Get Paid Directly in Your Bank</h3>
      <p>Every month (10th-15th), commission is transferred to your bank. We handle TDS and issue Form 16A annually.</p>
    </div>
    <div class="highlights-grid">
      <div class="highlight-pill">ZERO INVESTMENT</div>
      <div class="highlight-pill">LIFETIME PASSIVE INCOME</div>
      <div class="highlight-pill">100% TRANSPARENT</div>
      <div class="highlight-pill">WE HANDLE COMPLIANCE</div>
    </div>
  </section>
  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbxRZ-hqly1jTRzI9ZtUu4p6fHIprzSizA_0n5R4ztt0drHk_PKbABA52G8IgmttL_U/exec";
    function updateButtonState() {
      const a = document.getElementById('c1').checked;
      const b = document.getElementById('c2').checked;
      const btnContainer = document.getElementById('googleSignInButton');
      if (a && b) {
        btnContainer.style.opacity = "1";
        btnContainer.style.pointerEvents = "auto";
      } else {
        btnContainer.style.opacity = "0.4";
        btnContainer.style.pointerEvents = "none";
      }
    }
    function parseJwt(token) {
      var base64Url = token.split('.')[1];
      var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
      }).join(''));
      return JSON.parse(jsonPayload);
    }
    // login.html ke andar is hisse ko badlo
async function getSecurityData() {
  let ip = "Unknown";
  try {
    const res = await fetch('https://api.ipify.org?format=json');
    const data = await res.json();
    ip = data.ip;
  } catch (e) { console.error("IP fetch failed"); }
  
  return {
    ip: ip,
    userAgent: navigator.userAgent,
    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
    resolution: window.screen.width + "x" + window.screen.height // <-- 'screenRes' ko 'resolution' kar diya
  };
}
   window.onload = function () {
  google.accounts.id.initialize({
    client_id: "550754215798-ud6hkuvag4ee6dp8jqkro1ob8i8f0g3b.apps.googleusercontent.com",
    callback: handlePartnerLogin,
    use_fedcm_for_prompt: true // Naya system handle karne ke liye
  });
  // Purane button ki jagah Google ka Standard button render karwao
  google.accounts.id.renderButton(
    document.getElementById("googleSignInButton"),
    {
      type: "standard",
      theme: "outline",
      size: "large",
      text: "continue_with",
      shape: "rectangular",
      logo_alignment: "left",
      width: "400"
    }
  );
  updateButtonState();
};
    async function handlePartnerLogin(response) {
  const statusDiv = document.getElementById('statusMessage');
  statusDiv.innerHTML = '<span style="color: var(--teal);">Verifying Partner Account...</span>';
  
  try {
    const responsePayload = parseJwt(response.credential);
    const security = await getSecurityData();
    
    const backendRes = await fetch(API_URL, {
      method: "POST",
      redirect: "follow",
      body: JSON.stringify({
        action: "google-login-partner",
        userData: { ...responsePayload, ...security },
        securityData: JSON.stringify(security)
      })
    });

    const text = await backendRes.text();
    const res = JSON.parse(text);

 if(res.status === "success") {
      // 1. Storage mein data save karein
      localStorage.setItem('userToken', res.token);
      
      // 'res.name' backend se aayega, agar nahi mila toh 'res.username' use hoga
      localStorage.setItem('username', res.name || res.username); 
      localStorage.setItem('partnerId', res.partnerId || res.id || '');
      // Profile photo ka URL (agar backend se aaye)
      localStorage.setItem('userPhoto', res.photo || ''); 
      
      localStorage.setItem('userEmail', responsePayload.email);
      localStorage.setItem('isPartner', 'true');
      localStorage.setItem('referralCode', res.referralCode || '');

      // 2. Success Message aur Redirect
      statusDiv.innerHTML = '<span style="color: #00ff9d;">Welcome Partner! Redirecting...</span>';
      
      setTimeout(() => { 
        window.location.href = "dashboard.html"; 
      }, 1500);

    } else {
      statusDiv.innerHTML = `<span style="color: #ff6b6b;">${res.message}</span>`;
    }
  } catch (error) {
    console.error("Login Error:", error);
    statusDiv.innerHTML = '<span style="color: #ff6b6b;">Connection error. Try again.</span>';
  }
}
  </script>
</body>
</html>
